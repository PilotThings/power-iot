{"TopParent":{"Type":"ControlInfo","Name":"MilesightAM103","Template":{"Id":"http://microsoft.com/appmagic/Component","Version":"638005871149590088","LastModifiedTimestamp":"638006625403915885","Name":"ccac41f1629a41b2a9501e7561994864","FirstParty":true,"IsPremiumPcfControl":false,"IsCustomGroupControlTemplate":false,"CustomGroupControlTemplateName":"","IsComponentDefinition":true,"CustomProperties":[{"Name":"SensorId","Category":0,"Type":"{\"Version\":\"1.326\",\"Type\":{\"Name\":\"Root\",\"Kind\":\"String\",\"EnumString\":\"\",\"Type\":[]}}","PropertyDataTypeKey":"String","Hidden":false,"IsResettable":true,"DisplayName":"SensorId","Tooltip":"AM103 sensor"},{"Name":"co2","Category":0,"Type":"{\"Version\":\"1.326\",\"Type\":{\"Name\":\"Root\",\"Kind\":\"Number\",\"EnumString\":\"\",\"Type\":[]}}","PropertyDataTypeKey":"Number","Hidden":true,"DisplayName":"co2","Tooltip":"A custom property"}],"ComponentType":"CanvasComponent","OverridableProperties":{}},"Index":1.0,"PublishOrderIndex":0,"VariantName":"","LayoutName":"","MetaDataIDKey":"","PersistMetaDataIDKey":false,"IsFromScreenLayout":false,"StyleName":"","Parent":"","IsDataControl":false,"AllowAccessToGlobals":false,"IsGroupControl":false,"IsAutoGenerated":false,"Rules":[{"Property":"SensorId","Category":"Data","InvariantScript":"\"Sensor Id\"","RuleProviderType":"System"},{"Property":"co2","Category":"Data","InvariantScript":"Internalco2","RuleProviderType":"System"},{"Property":"Height","Category":"Design","InvariantScript":"150","RuleProviderType":"System"},{"Property":"Width","Category":"Design","InvariantScript":"150","RuleProviderType":"System"},{"Property":"X","Category":"Design","InvariantScript":"0","RuleProviderType":"System"},{"Property":"Y","Category":"Design","InvariantScript":"0","RuleProviderType":"System"},{"Property":"ZIndex","Category":"Design","InvariantScript":"1","RuleProviderType":"System"},{"Property":"Fill","Category":"Design","InvariantScript":"RGBA(0, 0, 0, 0)","RuleProviderType":"System"},{"Property":"OnReset","Category":"Behavior","InvariantScript":"","RuleProviderType":"System"}],"ControlPropertyState":["Fill",{"InvariantPropertyName":"Height","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"Width","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"X","Y","ZIndex","SensorId",{"InvariantPropertyName":"OnReset","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"Select","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"co2","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"100","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""}],"IsLocked":false,"ControlUniqueId":"5","Children":[{"Type":"ControlInfo","Name":"ProductImage","HasDynamicProperties":false,"Template":{"Id":"http://microsoft.com/appmagic/image","Version":"2.2.2","LastModifiedTimestamp":"0","Name":"image","FirstParty":true,"IsPremiumPcfControl":false,"IsCustomGroupControlTemplate":false,"CustomGroupControlTemplateName":"","IsComponentDefinition":false,"OverridableProperties":{}},"Index":0.0,"PublishOrderIndex":0,"VariantName":"","LayoutName":"","MetaDataIDKey":"","PersistMetaDataIDKey":false,"IsFromScreenLayout":false,"StyleName":"defaultImageStyle","Parent":"MilesightAM103","IsDataControl":false,"AllowAccessToGlobals":true,"IsGroupControl":false,"IsAutoGenerated":false,"Rules":[{"Property":"Tooltip","Category":"Data","InvariantScript":"\"Co2 : \" & Internalco2 & \" ppm\r\n\" &\r\n\"Time: \" & Internalco2Timestamp\r\n","RuleProviderType":"Unknown"},{"Property":"Image","Category":"Data","InvariantScript":"AM103","RuleProviderType":"Unknown"},{"Property":"FocusedBorderThickness","Category":"Design","InvariantScript":"2","RuleProviderType":"Unknown"},{"Property":"Height","Category":"Design","InvariantScript":"MilesightAM103.Height","RuleProviderType":"Unknown"},{"Property":"BorderThickness","Category":"Design","InvariantScript":"2","RuleProviderType":"Unknown"},{"Property":"RadiusBottomRight","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"RadiusBottomLeft","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"RadiusTopRight","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"RadiusTopLeft","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"ZIndex","Category":"Design","InvariantScript":"1","RuleProviderType":"Unknown"},{"Property":"DisplayMode","Category":"Design","InvariantScript":"DisplayMode.Edit","RuleProviderType":"Unknown"},{"Property":"Transparency","Category":"Design","InvariantScript":"0\r\n\r\n","RuleProviderType":"Unknown"},{"Property":"PaddingLeft","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"BorderStyle","Category":"Design","InvariantScript":"BorderStyle.Solid","RuleProviderType":"Unknown"},{"Property":"DisabledBorderColor","Category":"Design","InvariantScript":"RGBA(166, 166, 166, 1)","RuleProviderType":"Unknown"},{"Property":"PaddingBottom","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"PaddingRight","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"PaddingTop","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"BorderColor","Category":"Design","InvariantScript":"RGBA(0, 134, 208, 1)","RuleProviderType":"Unknown"},{"Property":"DisabledFill","Category":"Design","InvariantScript":"RGBA(244, 244, 244, 1)","RuleProviderType":"Unknown"},{"Property":"Fill","Category":"Design","InvariantScript":"RGBA(0, 0, 0, 0)","RuleProviderType":"Unknown"},{"Property":"Width","Category":"Design","InvariantScript":"MilesightAM103.Width","RuleProviderType":"Unknown"},{"Property":"Y","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"X","Category":"Design","InvariantScript":"0","RuleProviderType":"Unknown"},{"Property":"ImageRotation","Category":"Design","InvariantScript":"ImageRotation.None","RuleProviderType":"Unknown"},{"Property":"ImagePosition","Category":"Design","InvariantScript":"ImagePosition.Stretch","RuleProviderType":"Unknown"},{"Property":"FocusedBorderColor","Category":"Design","InvariantScript":"Self.BorderColor","RuleProviderType":"Unknown"},{"Property":"HoverBorderColor","Category":"Design","InvariantScript":"ColorFade(Self.BorderColor, 20%)","RuleProviderType":"Unknown"},{"Property":"PressedBorderColor","Category":"Design","InvariantScript":"ColorFade(Self.BorderColor, -20%)","RuleProviderType":"Unknown"},{"Property":"HoverFill","Category":"Design","InvariantScript":"ColorFade(Self.Fill, 20%)","RuleProviderType":"Unknown"},{"Property":"PressedFill","Category":"Design","InvariantScript":"ColorFade(Self.Fill, -20%)","RuleProviderType":"Unknown"},{"Property":"OnSelect","Category":"Behavior","InvariantScript":"","RuleProviderType":"Unknown"}],"ControlPropertyState":[{"InvariantPropertyName":"Image","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"SampleImage","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"ImagePosition","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"ImageRotation","X",{"InvariantPropertyName":"Y","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"Width","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"Height","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"148","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"Fill","DisabledFill","PressedFill","HoverFill",{"InvariantPropertyName":"BorderColor","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"DisabledBorderColor","PressedBorderColor","HoverBorderColor","FocusedBorderColor","BorderStyle","DisplayMode","ZIndex","RadiusTopLeft","RadiusTopRight","RadiusBottomLeft","RadiusBottomRight",{"InvariantPropertyName":"BorderThickness","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"FocusedBorderThickness","PaddingTop","PaddingRight","PaddingBottom","PaddingLeft",{"InvariantPropertyName":"Transparency","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"0","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"Tooltip","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"OnSelect","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"false","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""}],"IsLocked":false,"ControlUniqueId":"6","Children":[]},{"Type":"ControlInfo","Name":"iconRefresh","HasDynamicProperties":false,"Template":{"Id":"http://microsoft.com/appmagic/icon","Version":"2.5.0","LastModifiedTimestamp":"0","Name":"icon","FirstParty":true,"IsPremiumPcfControl":false,"IsCustomGroupControlTemplate":false,"CustomGroupControlTemplateName":"","IsComponentDefinition":false,"OverridableProperties":{}},"Index":0.0,"PublishOrderIndex":1,"VariantName":"Reload","LayoutName":"","MetaDataIDKey":"","PersistMetaDataIDKey":false,"IsFromScreenLayout":false,"StyleName":"defaultIconStyle","Parent":"MilesightAM103","IsDataControl":false,"AllowAccessToGlobals":true,"IsGroupControl":false,"IsAutoGenerated":false,"Rules":[{"Property":"Tooltip","Category":"Data","InvariantScript":"\"Press to update\"","RuleProviderType":"Unknown"},{"Property":"Width","Category":"Design","InvariantScript":"28","RuleProviderType":"Unknown"},{"Property":"Y","Category":"Design","InvariantScript":"ProductImage.Height/2-iconRefresh.Height/2","RuleProviderType":"Unknown"},{"Property":"X","Category":"Design","InvariantScript":"ProductImage.Width/2-iconRefresh.Width/2","RuleProviderType":"Unknown"},{"Property":"FocusedBorderThickness","Category":"Design","InvariantScript":"2","RuleProviderType":"Unknown"},{"Property":"DisplayMode","Category":"Design","InvariantScript":"DisplayMode.Edit","RuleProviderType":"Unknown"},{"Property":"BorderThickness","Category":"Design","InvariantScript":"1","RuleProviderType":"Unknown"},{"Property":"ZIndex","Category":"Design","InvariantScript":"4","RuleProviderType":"Unknown"},{"Property":"DisabledBorderColor","Category":"Design","InvariantScript":"RGBA(166, 166, 166, 1)","RuleProviderType":"Unknown"},{"Property":"Fill","Category":"Design","InvariantScript":"RGBA(255, 255, 255, 1)","RuleProviderType":"Unknown"},{"Property":"DisabledColor","Category":"Design","InvariantScript":"RGBA(244, 244, 244, 1)","RuleProviderType":"Unknown"},{"Property":"Color","Category":"Design","InvariantScript":"RGBA(141, 198, 63, 1)","RuleProviderType":"Unknown"},{"Property":"Icon","Category":"Design","InvariantScript":"Icon.Reload","RuleProviderType":"Unknown"},{"Property":"FocusedBorderColor","Category":"Design","InvariantScript":"Self.BorderColor","RuleProviderType":"Unknown"},{"Property":"HoverBorderColor","Category":"Design","InvariantScript":"ColorFade(Self.BorderColor, 20%)","RuleProviderType":"Unknown"},{"Property":"PressedBorderColor","Category":"Design","InvariantScript":"ColorFade(Self.BorderColor, -20%)","RuleProviderType":"Unknown"},{"Property":"HoverFill","Category":"Design","InvariantScript":"Self.Fill","RuleProviderType":"Unknown"},{"Property":"BorderColor","Category":"Design","InvariantScript":"RGBA(0, 134, 208, 1)","RuleProviderType":"Unknown"},{"Property":"BorderStyle","Category":"Design","InvariantScript":"BorderStyle.Solid","RuleProviderType":"Unknown"},{"Property":"Height","Category":"Design","InvariantScript":"28","RuleProviderType":"Unknown"},{"Property":"PressedFill","Category":"Design","InvariantScript":"Self.Fill","RuleProviderType":"Unknown"},{"Property":"DisabledFill","Category":"Design","InvariantScript":"Self.Fill","RuleProviderType":"Unknown"},{"Property":"HoverColor","Category":"Design","InvariantScript":"ColorFade(Self.Color, 20%)","RuleProviderType":"Unknown"},{"Property":"PressedColor","Category":"Design","InvariantScript":"ColorFade(Self.Color, -20%)","RuleProviderType":"Unknown"},{"Property":"PaddingTop","Category":"Design","InvariantScript":"3","RuleProviderType":"Unknown"},{"Property":"PaddingBottom","Category":"Design","InvariantScript":"3","RuleProviderType":"Unknown"},{"Property":"OnSelect","Category":"Behavior","InvariantScript":"If (\r\n    MilesightAM103.SensorId <> \"Sensor Id\",\r\n// if sensorid is provided\r\n    Set(Internalco2,\r\n        Last(\r\n            PilotThings.getLastMeasures(MilesightAM103.SensorId)\r\n            ).value\r\n        );\r\n    \r\n    Set(Internalco2Timestamp, \r\n        Text(\r\n            DateAdd(\r\n                DateTimeValue (\"12/31/1969 8:00 PM\"),\r\n                    Last(\r\n                        PilotThings.getLastMeasures(MilesightAM103.SensorId)\r\n                    ).timestamp,\r\n        Seconds\r\n        ),\r\n        \"dd/mm/yyyy - hh:mm:ss\"\r\n        )\r\n    )\r\n)","RuleProviderType":"Unknown"}],"ControlPropertyState":["Icon",{"InvariantPropertyName":"Color","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"DisabledColor","PressedColor","HoverColor",{"InvariantPropertyName":"Fill","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"DisabledFill","PressedFill","HoverFill","DisplayMode",{"InvariantPropertyName":"X","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"Y","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"Width","Height",{"InvariantPropertyName":"BorderStyle","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"BorderColor","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"DisabledBorderColor","PressedBorderColor","HoverBorderColor","FocusedBorderColor","ZIndex",{"InvariantPropertyName":"BorderThickness","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},"FocusedBorderThickness",{"InvariantPropertyName":"OnSelect","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"false","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"PaddingTop","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"PaddingBottom","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""},{"InvariantPropertyName":"Tooltip","AutoRuleBindingEnabled":false,"AutoRuleBindingString":"","NameMapSourceSchema":"?","IsLockable":false,"AFDDataSourceName":""}],"IsLocked":false,"ControlUniqueId":"7","Children":[]}]}}